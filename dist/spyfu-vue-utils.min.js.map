{"version":3,"file":"spyfu-vue-utils.min.js","sources":["../src/bind_external_event.js","../src/component_interval.js","../src/component_timeout.js","../src/plugin.js"],"sourcesContent":["/**\n * Bind an event to an element outside the scope of a Vue component.\n *\n * @param {Vue}         vm          vue component managing the event\n * @param {HTMLElement} targetEl    html element to bind an event listener to\n * @param  {...any}     args        all other event arguments \n */\nexport default function bindExternalEvent(vm, targetEl, ...args) {\n    targetEl.addEventListener(...args);\n\n    const unbind = () => {\n        targetEl.removeEventListener(...args);\n    }\n\n    vm.$on('hook:destroyed', unbind);\n\n    return {\n        unbind,\n    };\n}\n","/**\n * Create an interval that is cleaned up when the component is destroyed.\n * \n * @param  {Vue}        vm\n * @param  {Function}   callback\n * @param  {Number}     ms\n * @return {Function}\n */\nexport default function componentInterval(vm, callback, ms) {\n    const interval = setInterval(callback, ms);\n\n    const cancel = () => clearInterval(interval);\n    \n    vm.$once('hook:destroyed', cancel);\n\n    return { cancel };\n}\n","let timeouts = [];\n\n/**\n * Bind setTimeout() call to a component.\n *\n * @param {Vue}         vm          component managing the timeout\n * @param {Function}    callback    function to execute\n * @param {Number}      md          timeout duration in milliseconds\n */\nexport default function componentTimeout(vm, callback, ms) {\n    // track which timeouts are bound to our component, and when that\n    // it is destroyed make sure to cancel any lingering timeouts\n    let componentTimeouts = timeouts.find(obj => obj.vm === vm);\n\n    if (!componentTimeouts) {\n        componentTimeouts = { vm, timeouts: [] };\n\n        timeouts.push(componentTimeouts);\n\n        vm.$once('hook:destroyed', () => {\n            componentTimeouts.timeouts.forEach(clearTimeout);\n            timeouts = timeouts.filter(obj => obj.vm !== vm);\n        });\n    }\n\n    // once a timeout has been executed or canceled, remove it\n    // from our componentTimeouts that need to be cleaned up\n    function removeTimeoutById(timeoutId) {\n        if (componentTimeouts) {\n            const index = componentTimeouts.timeouts.findIndex(pendingId => pendingId === timeoutId);\n\n            if (index > -1) {\n                componentTimeouts.timeouts.splice(index, 1);\n            }\n        }\n    }\n\n    // queue the timeout, and keep track of it so it can be cleaned up\n    // if the component is destroyed before this timeout is executed.\n    const id = setTimeout(() => {\n        callback();\n        removeTimeoutById(id);\n    }, ms);\n\n    componentTimeouts.timeouts.push(id);\n\n    // return a function to manually cancel up a timeout\n    return {\n        cancel: () => {\n            clearTimeout(id);\n            removeTimeoutById(id);\n        },\n    };\n}","import bindExternalEvent from './bind_external_event';\nimport componentInterval from './component_interval';\nimport componentTimeout from './component_timeout';\n\nexport default {\n    install(Vue) {\n        Vue.prototype.$bindExternalEvent = function(...args) {\n            return bindExternalEvent(this, ...args);\n        }\n\n        Vue.prototype.$interval = function(...args) {\n            return componentInterval(this, ...args);\n        }\n\n        Vue.prototype.$timeout = function(...args) {\n            return componentTimeout(this, ...args);\n        }\n    },\n};\n"],"names":["bindExternalEvent","vm","targetEl","args","addEventListener","unbind","removeEventListener","$on","componentInterval","callback","ms","interval","setInterval","cancel","clearInterval","$once","timeouts","componentTimeout","componentTimeouts","find","obj","removeTimeoutById","timeoutId","index","findIndex","pendingId","splice","push","forEach","clearTimeout","filter","id","setTimeout","install","Vue","prototype","$bindExternalEvent","this","$interval","$timeout"],"mappings":"mNAOe,SAASA,EAAkBC,EAAIC,8BAAaC,mCAAAA,oBACvDD,EAASE,uBAATF,EAA6BC,OAEvBE,EAAS,WACXH,EAASI,0BAATJ,EAAgCC,WAGpCF,EAAGM,IAAI,iBAAkBF,GAElB,CACHA,OAAAA,GCTO,SAASG,EAAkBP,EAAIQ,EAAUC,OAC9CC,EAAWC,YAAYH,EAAUC,GAEjCG,EAAS,kBAAMC,cAAcH,WAEnCV,EAAGc,MAAM,iBAAkBF,GAEpB,CAAEA,OAAAA,GCfb,IAAIG,EAAW,GASA,SAASC,EAAiBhB,EAAIQ,EAAUC,OAG/CQ,EAAoBF,EAASG,KAAK,SAAAC,UAAOA,EAAInB,KAAOA,aAe/CoB,EAAkBC,MACnBJ,EAAmB,KACbK,EAAQL,EAAkBF,SAASQ,UAAU,SAAAC,UAAaA,IAAcH,KAEjE,EAATC,GACAL,EAAkBF,SAASU,OAAOH,EAAO,IAlBhDL,IACDA,EAAoB,CAAEjB,GAAAA,EAAIe,SAAU,IAEpCA,EAASW,KAAKT,GAEdjB,EAAGc,MAAM,iBAAkB,WACvBG,EAAkBF,SAASY,QAAQC,cACnCb,EAAWA,EAASc,OAAO,SAAAV,UAAOA,EAAInB,KAAOA,WAkB/C8B,EAAKC,WAAW,WAClBvB,IACAY,EAAkBU,IACnBrB,UAEHQ,EAAkBF,SAASW,KAAKI,GAGzB,CACHlB,OAAQ,WACJgB,aAAaE,GACbV,EAAkBU,WC9Cf,CACXE,iBAAQC,GACJA,EAAIC,UAAUC,mBAAqB,sCAAYjC,2BAAAA,yBACpCH,gBAAkBqC,aAASlC,KAGtC+B,EAAIC,UAAUG,UAAY,sCAAYnC,2BAAAA,yBAC3BK,gBAAkB6B,aAASlC,KAGtC+B,EAAIC,UAAUI,SAAW,sCAAYpC,2BAAAA,yBAC1Bc,gBAAiBoB,aAASlC"}