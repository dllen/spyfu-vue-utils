{"version":3,"file":"spyfu-vue-utils.js","sources":["../src/bind_external_event.js","../src/component_interval.js","../src/component_timeout.js"],"sourcesContent":["/**\n * Bind an event to an element outside the scope of a Vue component.\n *\n * @param {Vue}         vm          vue component managing the event\n * @param {HTMLElement} targetEl    html element to bind an event listener to\n * @param  {...any}     args        all other event arguments \n */\nexport default function bindExternalEvent(vm, targetEl, ...args) {\n    targetEl.addEventListener(...args);\n\n    vm.$on('hook:destroyed', () => {\n        targetEl.removeEventListener(...args);\n    });\n}\n","/**\n * Create an interval that is cleaned up when the component is destroyed.\n * \n * @param  {Vue}        vm\n * @param  {Function}   callback\n * @param  {Number}     ms\n * @return {Function}\n */\nexport default function componentInterval(vm, callback, ms) {\n    const interval = setInterval(callback, ms);\n\n    const cancel = () => clearInterval(interval);\n    \n    vm.$once('hook:destroyed', cancel);\n\n    return { cancel };\n}\n","let timeouts = [];\n\n/**\n * Bind setTimeout() call to a component.\n *\n * @param {Vue}         vm          component managing the timeout\n * @param {Function}    callback    function to execute\n * @param {Number}      md          timeout duration in milliseconds\n */\nexport default function componentTimeout(vm, callback, ms) {\n    // track which timeouts are bound to our component, and when that\n    // it is destroyed make sure to cancel any lingering timeouts\n    let componentTimeouts = timeouts.find(obj => obj.vm === vm);\n\n    if (!componentTimeouts) {\n        componentTimeouts = { vm, timeouts: [] };\n\n        timeouts.push(componentTimeouts);\n\n        vm.$once('hook:destroyed', () => {\n            componentTimeouts.timeouts.forEach(clearTimeout);\n            timeouts = timeouts.filter(obj => obj.vm !== vm);\n        });\n    }\n\n    // once a timeout has been executed or canceled, remove it\n    // from our componentTimeouts that need to be cleaned up\n    function removeTimeoutById(timeoutId) {\n        if (componentTimeouts) {\n            const index = componentTimeouts.timeouts.findIndex(pendingId => pendingId === timeoutId);\n\n            if (index > -1) {\n                componentTimeouts.timeouts.splice(index, 1);\n            }\n        }\n    }\n\n    // queue the timeout, and keep track of it so it can be cleaned up\n    // if the component is destroyed before this timeout is executed.\n    const id = setTimeout(() => {\n        callback();\n        removeTimeoutById(id);\n    }, ms);\n\n    componentTimeouts.timeouts.push(id);\n\n    // return a function to manually cancel up a timeout\n    return {\n        cancel: () => {\n            clearTimeout(id);\n            removeTimeoutById(id);\n        },\n    };\n}"],"names":["bindExternalEvent","vm","targetEl","args","addEventListener","$on","removeEventListener","componentInterval","callback","ms","interval","setInterval","cancel","clearInterval","$once","timeouts","componentTimeout","componentTimeouts","find","obj","push","forEach","clearTimeout","filter","removeTimeoutById","timeoutId","index","findIndex","pendingId","splice","id","setTimeout"],"mappings":";;;;;;IAAA;;;;;;;AAOA,IAAe,SAASA,iBAAT,CAA2BC,EAA3B,EAA+BC,QAA/B,EAAkD;IAAA,oCAANC,IAAM;IAANA,IAAAA,IAAM;IAAA;;IAC7DD,EAAAA,QAAQ,CAACE,gBAAT,OAAAF,QAAQ,EAAqBC,IAArB,CAAR;IAEAF,EAAAA,EAAE,CAACI,GAAH,CAAO,gBAAP,EAAyB,YAAM;IAC3BH,IAAAA,QAAQ,CAACI,mBAAT,OAAAJ,QAAQ,EAAwBC,IAAxB,CAAR;IACH,GAFD;IAGH;;ICbD;;;;;;;;AAQA,IAAe,SAASI,iBAAT,CAA2BN,EAA3B,EAA+BO,QAA/B,EAAyCC,EAAzC,EAA6C;IACxD,MAAMC,QAAQ,GAAGC,WAAW,CAACH,QAAD,EAAWC,EAAX,CAA5B;;IAEA,MAAMG,MAAM,GAAG,SAATA,MAAS;IAAA,WAAMC,aAAa,CAACH,QAAD,CAAnB;IAAA,GAAf;;IAEAT,EAAAA,EAAE,CAACa,KAAH,CAAS,gBAAT,EAA2BF,MAA3B;IAEA,SAAO;IAAEA,IAAAA,MAAM,EAANA;IAAF,GAAP;IACH;;IChBD,IAAIG,QAAQ,GAAG,EAAf;IAEA;;;;;;;;AAOA,IAAe,SAASC,gBAAT,CAA0Bf,EAA1B,EAA8BO,QAA9B,EAAwCC,EAAxC,EAA4C;IACvD;IACA;IACA,MAAIQ,iBAAiB,GAAGF,QAAQ,CAACG,IAAT,CAAc,UAAAC,GAAG;IAAA,WAAIA,GAAG,CAAClB,EAAJ,KAAWA,EAAf;IAAA,GAAjB,CAAxB;;IAEA,MAAI,CAACgB,iBAAL,EAAwB;IACpBA,IAAAA,iBAAiB,GAAG;IAAEhB,MAAAA,EAAE,EAAFA,EAAF;IAAMc,MAAAA,QAAQ,EAAE;IAAhB,KAApB;IAEAA,IAAAA,QAAQ,CAACK,IAAT,CAAcH,iBAAd;IAEAhB,IAAAA,EAAE,CAACa,KAAH,CAAS,gBAAT,EAA2B,YAAM;IAC7BG,MAAAA,iBAAiB,CAACF,QAAlB,CAA2BM,OAA3B,CAAmCC,YAAnC;IACAP,MAAAA,QAAQ,GAAGA,QAAQ,CAACQ,MAAT,CAAgB,UAAAJ,GAAG;IAAA,eAAIA,GAAG,CAAClB,EAAJ,KAAWA,EAAf;IAAA,OAAnB,CAAX;IACH,KAHD;IAIH,GAdsD;IAiBvD;;;IACA,WAASuB,iBAAT,CAA2BC,SAA3B,EAAsC;IAClC,QAAIR,iBAAJ,EAAuB;IACnB,UAAMS,KAAK,GAAGT,iBAAiB,CAACF,QAAlB,CAA2BY,SAA3B,CAAqC,UAAAC,SAAS;IAAA,eAAIA,SAAS,KAAKH,SAAlB;IAAA,OAA9C,CAAd;;IAEA,UAAIC,KAAK,GAAG,CAAC,CAAb,EAAgB;IACZT,QAAAA,iBAAiB,CAACF,QAAlB,CAA2Bc,MAA3B,CAAkCH,KAAlC,EAAyC,CAAzC;IACH;IACJ;IACJ,GA1BsD;IA6BvD;;;IACA,MAAMI,EAAE,GAAGC,UAAU,CAAC,YAAM;IACxBvB,IAAAA,QAAQ;IACRgB,IAAAA,iBAAiB,CAACM,EAAD,CAAjB;IACH,GAHoB,EAGlBrB,EAHkB,CAArB;IAKAQ,EAAAA,iBAAiB,CAACF,QAAlB,CAA2BK,IAA3B,CAAgCU,EAAhC,EAnCuD;;IAsCvD,SAAO;IACHlB,IAAAA,MAAM,EAAE,kBAAM;IACVU,MAAAA,YAAY,CAACQ,EAAD,CAAZ;IACAN,MAAAA,iBAAiB,CAACM,EAAD,CAAjB;IACH;IAJE,GAAP;IAMH;;;;;;;;;;;;;;"}