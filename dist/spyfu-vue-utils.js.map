{"version":3,"file":"spyfu-vue-utils.js","sources":["../src/bind_external_event.js","../src/component_timeout.js","../src/component_ease.js","../src/component_interval.js","../src/plugin.js"],"sourcesContent":["/**\n * Bind an event to an element outside the scope of a Vue component.\n *\n * @param {Vue}         vm          vue component managing the event\n * @param {HTMLElement} targetEl    html element to bind an event listener to\n * @param {...any}      args        all other event arguments \n */\nexport default function bindExternalEvent(vm, targetEl, ...args) {\n    targetEl.addEventListener(...args);\n\n    const unbind = () => {\n        targetEl.removeEventListener(...args);\n    }\n\n    vm.$on('hook:destroyed', unbind);\n\n    return {\n        unbind,\n    };\n}\n","let timeouts = [];\n\n/**\n * Bind setTimeout() call to a component.\n *\n * @param {Vue}         vm          component managing the timeout\n * @param {Function}    callback    function to execute\n * @param {Number}      md          timeout duration in milliseconds\n */\nexport default function componentTimeout(vm, callback, ms) {\n    // track which timeouts are bound to our component, and when that\n    // it is destroyed make sure to cancel any lingering timeouts\n    let componentTimeouts = timeouts.find(obj => obj.vm === vm);\n\n    if (!componentTimeouts) {\n        componentTimeouts = { vm, timeouts: [] };\n\n        timeouts.push(componentTimeouts);\n\n        vm.$once('hook:destroyed', () => {\n            componentTimeouts.timeouts.forEach(clearTimeout);\n            timeouts = timeouts.filter(obj => obj.vm !== vm);\n        });\n    }\n\n    // once a timeout has been executed or canceled, remove it\n    // from our componentTimeouts that need to be cleaned up\n    function removeTimeoutById(timeoutId) {\n        if (componentTimeouts) {\n            const index = componentTimeouts.timeouts.findIndex(pendingId => pendingId === timeoutId);\n\n            if (index > -1) {\n                componentTimeouts.timeouts.splice(index, 1);\n            }\n        }\n    }\n\n    // queue the timeout, and keep track of it so it can be cleaned up\n    // if the component is destroyed before this timeout is executed.\n    const id = setTimeout(() => {\n        callback();\n        removeTimeoutById(id);\n    }, ms);\n\n    componentTimeouts.timeouts.push(id);\n\n    // return a function to manually cancel up a timeout\n    return {\n        cancel: () => {\n            clearTimeout(id);\n            removeTimeoutById(id);\n        },\n    };\n}","import componentTimeout from './component_timeout';\nimport bezierEasing from 'bezier-easing';\n\n/**\n * Create a component bound easing timeout.\n * \n * @param  {Vue}            vm\n * @param  {Function}       fn\n * @param  {number}         ms\n * @param  {Array<number>}  curve\n * @param  {number}         steps\n * @return {Function}\n */\nexport default function componentEase(vm, fn, ms, curve = [0.77, 0, 0.175, 1], steps = 0) {\n    // calculate the easing curve, and create an array\n    // to hold all of the timeouts we're about make\n    const easing = bezierEasing(...curve);\n    const frames = steps > 0 ? steps : 60 * (ms / 1000);\n    const timeouts = [];\n\n    // queue up each frame of the animation\n    for (let i = 0, end = frames - 1; i <= end; i += 1) {\n        const frame = i / end;\n\n        timeouts.push(\n            componentTimeout(vm, () => fn(+easing(frame).toFixed(4), i), frame * ms)\n        );\n    }\n\n    // and finally, return an object we can use to cancel the timeouts\n    return {\n        cancel: () => timeouts.forEach(timeout => timeout.cancel()),\n    };\n}","/**\n * Create an interval that is cleaned up when the component is destroyed.\n * \n * @param  {Vue}        vm\n * @param  {Function}   callback\n * @param  {Number}     ms\n * @return {Function}\n */\nexport default function componentInterval(vm, callback, ms) {\n    const interval = setInterval(callback, ms);\n\n    const cancel = () => clearInterval(interval);\n    \n    vm.$once('hook:destroyed', cancel);\n\n    return { cancel };\n}\n","import bindExternalEvent from './bind_external_event';\nimport componentEase from './component_ease';\nimport componentInterval from './component_interval';\nimport componentTimeout from './component_timeout';\n\nexport default {\n    install(Vue) {\n        Vue.prototype.$bindExternalEvent = function(...args) {\n            return bindExternalEvent(this, ...args);\n        }\n\n        Vue.prototype.$ease = function(...args) {\n            return componentEase(this, ...args);\n        }\n\n        Vue.prototype.$interval = function(...args) {\n            return componentInterval(this, ...args);\n        }\n\n        Vue.prototype.$timeout = function(...args) {\n            return componentTimeout(this, ...args);\n        }\n    },\n};\n"],"names":["bindExternalEvent","vm","targetEl","args","addEventListener","unbind","removeEventListener","$on","timeouts","componentTimeout","callback","ms","componentTimeouts","find","obj","push","$once","forEach","clearTimeout","filter","removeTimeoutById","timeoutId","index","findIndex","pendingId","splice","id","setTimeout","cancel","componentEase","fn","curve","steps","easing","bezierEasing","frames","i","end","frame","toFixed","timeout","componentInterval","interval","setInterval","clearInterval","install","Vue","prototype","$bindExternalEvent","$ease","$interval","$timeout"],"mappings":"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"}